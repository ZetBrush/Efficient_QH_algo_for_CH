Efficient QH algo for CH